<aside class="sidebar">
    <h2>Latest Posts</h2>
    <ul>
    {{ range first 5 (where .Site.RegularPages "Section" "blog") }}
        <li><a href="{{ .RelPermalink }}">{{ .Title }}</a> — <em>{{ .Date.Format "Jan 2, 2006" }}</em></li>
    {{ end }}
    </ul>
</aside>
<!--
<aside class="sidebar">
    <h2>Recent Comments</h2>
    <ul id="recent-comments">
        <li>Loading comments...</li>
    </ul>
</aside>

<script>
  (async () => {
    const commentList = document.getElementById("recent-comments");
    try {
      const res = await fetch("/api/get-latest-comments");
      if (!res.ok) throw new Error("Failed to load comments");

      const comments = await res.json();
      commentList.innerHTML = "";

      comments.forEach(comment => {
        const date = new Date(comment.timestamp).toLocaleDateString("en-US", {
          year: "numeric", month: "short", day: "numeric"
        });

        const li = document.createElement("li");
        li.innerHTML = `
          <a href="/blog/${comment.post_slug}">
            <strong>${comment.name}</strong> — <em>${date}</em>
          </a><br>
          ${comment.comment.length > 100 ? comment.comment.slice(0, 100) + "…" : comment.comment}
        `;
        commentList.appendChild(li);
      });

      if (comments.length === 0) {
        commentList.innerHTML = "<li>No comments yet.</li>";
      }
    } catch (err) {
      commentList.innerHTML = `<li>Error loading comments: ${err.message}</li>`;
    }
  })();
</script>
-->